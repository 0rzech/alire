language: none # ada

branches:
    only:
        - master
        - devel

build:
    pre_ci_boot:
        image_name: reznik/gnat
        image_tag: gpl.2017.slim
        pull: true
    ci:
        - echo Testing predefinded XML format
        - apt-get install -y lsb-release mercurial
        - git submodule update --init --recursive
        - /opt/gnat/bin/gprbuild -p -P alr_env
        - bash stress/selftest.sh docker
        - export PATH+=:`pwd`/bin
        - mkdir reltest 
        - cd reltest 
        - alr test --full
        - cp *.xml ../shippable/testresults 
